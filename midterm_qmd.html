<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>midterm_qmd</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="midterm_qmd_files/libs/clipboard/clipboard.min.js"></script>
<script src="midterm_qmd_files/libs/quarto-html/quarto.js"></script>
<script src="midterm_qmd_files/libs/quarto-html/popper.min.js"></script>
<script src="midterm_qmd_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="midterm_qmd_files/libs/quarto-html/anchor.min.js"></script>
<link href="midterm_qmd_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="midterm_qmd_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="midterm_qmd_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="midterm_qmd_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="midterm_qmd_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="instruction" class="level2">
<h2 class="anchored" data-anchor-id="instruction">Instruction</h2>
<p>The midterm has two components: the Rmarkdown notebook (html) and the presentation. We will do the presentation in class. Post both the notebook and the presentation on your Github page.</p>
<p><strong>The notebook:</strong> The notebook should be created using <code>rmarkdown</code> or Quarto (like other assignments). The notebook should have a title.</p>
<p><strong>The Presentation:</strong> Present your results in 5-10 minutes. To make the presentation using Rmarkdown, do the follows:</p>
<pre><code>- In Rstudio -&gt; File -&gt; New File -&gt; R markdown

- In the left panel, click to Presentation -&gt; Click OK

- Now you have an Rmarkdown that can be knitted to be a html presentation </code></pre>
<ul>
<li><p>You can also use the Rmd templates of the class slides.</p></li>
<li><p>You can also use Quarto to create the presentation: <em>In Rstudio -&gt; File -&gt; New File -&gt; Quarto Presentation…</em></p></li>
<li><p>You do not need to rerun all the codes for the presentation. For example, to show the model comparison, you just need to show the image of the model comparison instead of running all the models again.</p></li>
<li><p>To inset an image in a slide, use <code>![](image.png)</code></p></li>
<li><p>To scale images, you can use <code>![](image.png){width="60%"}</code> or follow these below instructions.</p>
<ul>
<li><p>https://bookdown.org/yihui/rmarkdown-cookbook/figure-size.html</p></li>
<li><p>http://zevross.com/blog/2017/06/19/tips-and-tricks-for-working-with-images-and-figures-in-r-markdown-documents/</p></li>
</ul></li>
<li><p>To turn off message and warning of a code cell, use: <code>{r, message=FALSE, warning=FALSE}</code> for the cell.</p></li>
<li><p>To turn off message and warning of a code cell, use: <code>{r, message=FALSE, warning=FALSE}</code> for the cell.</p></li>
</ul>
<p><strong>What to present</strong>:</p>
<ul>
<li><p>Present Part 2 - Visualization</p></li>
<li><p>Present Question Question 4, 5 and 6 in Part 3.</p></li>
<li><p>Present any errors/challenges you run into and how you fix/overcome them.</p></li>
</ul>
<p><strong>Data:</strong></p>
<p>The data for the mid-term project is the Rhode Island Department of Health Hospital Discharge Data. Each row of the data presents a patient.</p>
<p>Link: https://drive.google.com/open?id=15QNBf6YYKocK2nNIfpKDer58kQnCPNZJ</p>
<p><strong>Notice</strong></p>
<ul>
<li>Since this is a large dataset, you could try to run the codes on the smaller dataset, which is a portion of the original dataset before running the codes on the original data. To create a random subset of the data you could use</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find the number of rows of the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(df)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># subset 1000 rows of the data</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> df[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">1000</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="i.-data-wranggling" class="level2">
<h2 class="anchored" data-anchor-id="i.-data-wranggling">I. Data Wranggling</h2>
<ol type="1">
<li><p>Download the data file <code>hdd0318cy.sas7bdat</code>.</p></li>
<li><p>Use <code>read_sas</code> in library <code>haven</code> to read the data.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'haven' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tibble' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'purrr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stringr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'forcats' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lubridate' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">read_sas</span>(<span class="st">'hdd0318cy.sas7bdat'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Filter the data to have only patients of the year 2018 (<code>yod==18</code>)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(yod <span class="sc">==</span> <span class="dv">18</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Select to work with only following variables:</li>
</ol>
<p>“yod”, “payfix”,“pay_ub92”,“age”,<br>
“sex”,“raceethn”,“provider”,“moa”, “yoa”,“mod”,“admtype”, “asource” , “preopday” ,“los”, “service” , “icu”,“ccu”,<br>
“dispub92”, “payer” ,“drg”,“trandb”, “randbg”,“randbs”,“orr”, “anes”,“seq”,<br>
“lab”,“dtest”, “ther”,“blood”,“phar”, “other”,“patcon”,“bwght”,“total”,“tot” ,<br>
“ecodub92”,“b_wt”,“pt_state”,“diag_adm”,“ancilar” , “campus”,“er_fee”,“er_chrg”,“er_mode”,“obs_chrg”, “obs_hour”,“psycchrg”,“nicu_day”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"yod"</span>, <span class="st">"payfix"</span>,<span class="st">"pay_ub92"</span>,<span class="st">"age"</span>,  </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"sex"</span>,<span class="st">"raceethn"</span>,<span class="st">"provider"</span>,<span class="st">"moa"</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"yoa"</span>,<span class="st">"mod"</span>,<span class="st">"admtype"</span>, <span class="st">"asource"</span> , </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"preopday"</span> ,<span class="st">"los"</span>, <span class="st">"service"</span> , <span class="st">"icu"</span>,<span class="st">"ccu"</span>,    </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"dispub92"</span>, <span class="st">"payer"</span>  ,<span class="st">"drg"</span>,<span class="st">"trandb"</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"randbg"</span>,<span class="st">"randbs"</span>,<span class="st">"orr"</span>, <span class="st">"anes"</span>,<span class="st">"seq"</span>,   </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"lab"</span>,<span class="st">"dtest"</span>, <span class="st">"ther"</span>,<span class="st">"blood"</span>,<span class="st">"phar"</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"other"</span>,<span class="st">"patcon"</span>,<span class="st">"bwght"</span>,<span class="st">"total"</span>,<span class="st">"tot"</span> ,  </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"ecodub92"</span>,<span class="st">"b_wt"</span>,<span class="st">"pt_state"</span>,<span class="st">"diag_adm"</span>,<span class="st">"ancilar"</span> ,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"campus"</span>,<span class="st">"er_fee"</span>,<span class="st">"er_chrg"</span>,<span class="st">"er_mode"</span>,<span class="st">"obs_chrg"</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"obs_hour"</span>,<span class="st">"psycchrg"</span>,<span class="st">"nicu_day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Notice</em>: You may want to save the current data to your computer for easy access later. To save the data file use <code>write_csv(df, 'midterm.csv')</code>, for example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(df1, <span class="st">'MaseraEmilyMidterm.csv'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>What are variables that have missing values?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(df1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     yod   payfix pay_ub92      age      sex raceethn  filler1  filler2 
       0   131478        0        0        0        0        0        0 
provider      moa      yoa      mod  admtype  asource  filler3      dx1 
       0        0        0        0        0        0        0        0 
     dx2      dx3      dx4      dx5      dx6      dx7      px1      px2 
       0        0        0        0        0        0        0        0 
     px3      px4      px5      px6      px7      px8      px9     px10 
       0        0        0        0        0        0        0        0 
preopday      los  filler4  service      icu      ccu dispub92    payer 
   60486        0        0        0        0        0        0        0 
     drg   trandb   randbg   randbs      orr     anes      seq      lab 
       0        0        0        0        0        0        0        0 
   dtest     ther    blood     phar    other   patcon    bwght  filler6 
       0        0        0        0        0        0        0        0 
   total      tot      dx8      dx9     dx10     dx11 ecodub92     b_wt 
       0        0        0        0        0        0        0        0 
pt_state diag_adm  ancilar   campus   er_fee  er_chrg  er_mode obs_chrg 
       0        0        0        0        0        0        0        0 
obs_hour psycchrg nicu_day     dx12     dx13     dx14     dx15     dx16 
   77343        0   124090        0        0        0        0        0 
    dx17     dx18     dx19     dx20     dx21     dx22     dx23     dx24 
       0        0        0        0        0        0        0        0 
    dx25     px11     px12     px13     px14     px15     px16     px17 
       0        0        0        0        0        0        0        0 
    px18     px19     px20     px21     px22     px23     px24     px25 
       0        0        0        0        0        0        0        0 
 filler7     race   ethnic     poa1     poa2     poa3     poa4     poa5 
       0        0        0        0        0        0        0        0 
    poa6     poa7     poa8     poa9    poa10    poa11    poa12    poa13 
       0        0        0        0        0        0        0        0 
   poa14    poa15    poa16    poa17    poa18    poa19    poa20    poa21 
       0        0        0        0        0        0        0        0 
   poa22    poa23    poa24    poa25 ecodepoa  filler8 filler6a 
       0        0        0        0        0        0        0 </code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Remove all variables with missing values.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>payfix, <span class="sc">-</span>raceethn, <span class="sc">-</span>admtype, <span class="sc">-</span>asource, <span class="sc">-</span>preopday, <span class="sc">-</span>bwght, <span class="sc">-</span>ecodub92, <span class="sc">-</span>pt_state, <span class="sc">-</span>diag_adm, <span class="sc">-</span>er_mode, <span class="sc">-</span>obs_hour, <span class="sc">-</span>nicu_day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="7" type="1">
<li>Refer to the data description in the file <code>HDD2015-18cy6-20-19.docx</code>, which variable recording the month of admission?, which variable recording the month of discharge? ##The variable for month of admission is moa and the variable for month of discharge is mod##</li>
<li>Which month admitted the most number of patients? Which month admitted the most number of male patients?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">count</span>(moa) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
     moa     n
   &lt;dbl&gt; &lt;int&gt;
 1    10 11408
 2     5 11404
 3     1 11309
 4     8 11199
 5     4 11174
 6     3 11073
 7     7 10962
 8    12 10698
 9     6 10690
10     9 10666
11    11 10636
12     2 10259</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">##October admitted the most number of patients##</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">'1'</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>(moa) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
     moa     n
   &lt;dbl&gt; &lt;int&gt;
 1    10  5164
 2     5  5066
 3     8  5028
 4     4  4989
 5     3  4978
 6     1  4970
 7     7  4910
 8    12  4855
 9     6  4810
10    11  4800
11     9  4683
12     2  4546</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">##October also admitted the most male patients##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="9" type="1">
<li>Which month has the most number of teenage female patients?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">'2'</span>, age<span class="sc">&gt;=</span><span class="st">'13'</span><span class="sc">&amp;</span> age<span class="sc">&lt;=</span><span class="st">'19'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(moa) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
     moa     n
   &lt;dbl&gt; &lt;int&gt;
 1     3   226
 2     5   220
 3    10   212
 4    12   208
 5     1   207
 6     9   196
 7     4   187
 8    11   177
 9     2   172
10     8   172
11     7   171
12     6   169</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## March has the most number of teenage female patients##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="10" type="1">
<li>Which provider has the most number of female patients in October?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">'2'</span>, moa<span class="sc">==</span><span class="st">'10'</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>(provider) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   provider     n
   &lt;chr&gt;    &lt;int&gt;
 1 7205      1517
 2 7214      1224
 3 7204       872
 4 7210       699
 5 7209       351
 6 7206       333
 7 7213       317
 8 7201       294
 9 7216       256
10 7202       212
11 7211       122
12 7215        46</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">##provider 7205 has the most number of female patietns in October</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="11" type="1">
<li>Is female patients older than male patients, on average?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">average_age =</span> <span class="fu">mean</span>(age)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>average_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  sex   average_age
  &lt;chr&gt;       &lt;dbl&gt;
1 1            51.5
2 2            50.9
3 9            43  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Male patients are older on average##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="12" type="1">
<li>Calculate the average age of patients by months. Which month has the oldest patients on average age?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(moa) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">average_age =</span> <span class="fu">mean</span>(age)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>average_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
     moa average_age
   &lt;dbl&gt;       &lt;dbl&gt;
 1     1        51.8
 2     6        51.5
 3    12        51.5
 4     4        51.4
 5     7        51.3
 6     2        51.2
 7     3        51.1
 8    11        51.0
 9     8        50.9
10    10        50.8
11     5        50.6
12     9        50.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">##January has the oldest average age##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="13" type="1">
<li>What is the name of the provider that has the highest total charge?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(provider) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">average_tot =</span> <span class="fu">mean</span>(tot)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>average_tot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   provider average_tot
   &lt;chr&gt;          &lt;dbl&gt;
 1 7215          69946.
 2 7205          48739.
 3 7213          38200.
 4 7202          35504.
 5 7204          35277.
 6 7206          31018.
 7 7210          27691.
 8 7209          24539.
 9 7211          24089.
10 7201          22775.
11 7214          22362.
12 7216          17782.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Provider 7215 has the highest total charge##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="14" type="1">
<li>What is the name of the provider that has the least total charge for teenage male on average?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(provider) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">'1'</span>, age<span class="sc">&gt;=</span><span class="st">'13'</span><span class="sc">&amp;</span> age<span class="sc">&lt;=</span><span class="st">'19'</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">average_tot =</span> <span class="fu">mean</span>(tot)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(average_tot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   provider average_tot
   &lt;chr&gt;          &lt;dbl&gt;
 1 7206          10360.
 2 7201          14434.
 3 7210          18586.
 4 7211          19742.
 5 7213          22618.
 6 7216          24060.
 7 7204          24989.
 8 7209          26573.
 9 7214          28950 
10 7202          29389.
11 7205          40215.
12 7215         100440.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">##provider 7206 has the least total charge for teenage male on average##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="15" type="1">
<li>Create a season (Spring, Summer, Fall, Winter) variable. Calculate the length of stays by season. Which season has the longest length of stays on average?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>season <span class="ot">&lt;-</span> <span class="fu">case_when</span>(df<span class="sc">$</span>moa <span class="sc">&gt;=</span><span class="dv">3</span> <span class="sc">&amp;</span> df<span class="sc">$</span>moa <span class="sc">&lt;</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">'Spring'</span>, df<span class="sc">$</span>moa <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> df<span class="sc">$</span>moa <span class="sc">&lt;</span> <span class="dv">9</span> <span class="sc">~</span><span class="st">'Summer'</span>, df<span class="sc">$</span>moa <span class="sc">&gt;=</span><span class="dv">9</span> <span class="sc">&amp;</span> df<span class="sc">$</span>moa <span class="sc">&lt;</span><span class="dv">12</span> <span class="sc">~</span> <span class="st">'Fall'</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">'Winter'</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(season) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">average_los =</span> <span class="fu">mean</span>(los)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>average_los)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  season average_los
  &lt;chr&gt;        &lt;dbl&gt;
1 Summer        4.96
2 Fall          4.96
3 Winter        4.93
4 Spring        4.84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Summer has the longest length of stay on average##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="16" type="1">
<li>On average, how much a 20 year-old male get charged for staying 1 day in the Fall season?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">'1'</span>, age<span class="sc">==</span><span class="st">'20'</span>, season<span class="sc">==</span><span class="st">'Fall'</span>, los<span class="sc">==</span><span class="st">'1'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">average_tot =</span> <span class="fu">mean</span>(tot)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(average_tot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  average_tot
        &lt;dbl&gt;
1       16511</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">##On average, a 20 year old male gets charged $16,511 for staying 1 day in the fall season##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="17" type="1">
<li>Write a paragraph to summarize the section and give your comments on the results. You could do some other calculations to support your points. ##October tells to be the month that most people are admitted. The admitted people tend to be older and are females. However, older people tend to be admitted more in January. Summer has the longest length of stay and Bradley (provider 7215) has the highest charge of all providers.I used functions such as ‘filter’, ‘group_by’, ‘summarise’ and ‘arrange’ to come to all of these conclusions. I feel as though this dataset has so many other possible opportunties to use other functions within R to calculate statistics.##</li>
</ol>
<hr>
</section>
<section id="ii.-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="ii.-data-visualization">II. Data Visualization</h2>
<p>Continue with the data from part I.</p>
<ol type="1">
<li><p>Provides at least 10 meaningful plots. Comments on the plots. All plots should have title, caption, appropriate labels on x and y-axis</p></li>
<li><p>Make an animation plot.</p></li>
<li><p>Write a paragraph to summarize the section and give your comments on the results.</p></li>
</ol>
<hr>
</section>
<section id="iii.-predictive-models" class="level2">
<h2 class="anchored" data-anchor-id="iii.-predictive-models">III. Predictive Models</h2>
<p>Continue with the data from part I. Use the follows as the target and input variables:</p>
<p><em>Target Variable</em>: Create the target variable taking value of</p>
<ul>
<li><p><code>low</code> if the total charge of a patient (<code>tot</code>) is smaller than the median of the total charge, and</p></li>
<li><p><code>high</code> otherwise.</p></li>
</ul>
<p><em>Input Variables</em>:</p>
<ul>
<li>“provider”,“moa”,“mod”,“admtype”,“campus”, ‘los’,‘diag_adm’</li>
</ul>
<hr>
<ol type="1">
<li><p>Use <code>filter</code> function to filter out rows where <code>raceethn==''</code> or <code>admtype==''</code>. Make sure all the categorical variables are factor, numeric variables are numeric. Set Training : Testing Split = 10 : 90</p></li>
<li><p>Train a decision tree using <code>rpart</code>. Plot the decision tree. Plot the variable importance ranked by the tree.</p></li>
<li><p>Using caret for this question. Set <code>Training Control</code> to be: Use Cross-Validation of 5 folds across all models. Train &amp; tune at least 2 different models (i.e.&nbsp;two different values for <code>method=</code> in the train function of caret). Plot the hyper-parameter tuning plots for each model.</p></li>
<li><p>Plot the comparison of the models in 3.</p></li>
<li><p>What is your final selection for the model? Test the accuracy of your final model on the test data.</p></li>
<li><p>Create another <code>target</code> variable (binary), decide the input variables and redo 1 to 5.</p></li>
<li><p>Write a paragraph to summarize the section and give your comments on the results.</p></li>
</ol>
<hr>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>